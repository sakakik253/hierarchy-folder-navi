# フォルダナビゲーター Phase 3

## 📋 概要
試験結果フォルダの効率的管理ツール（会社PC制約対応）

**バージョン:** 3.0.0  
**作成日:** 2024-11-23  
**作者:** KENJI

---

## ✨ 主な機能

### 基本機能
- ✅ フォルダツリー表示（階層構造・遅延読み込み）
- ✅ ファイル・フォルダ一覧表示（DataGrid）
- ✅ リアルタイム検索
- ✅ 新規フォルダ作成
- ✅ 試験項目フォルダ自動作成（連番対応）
- ✅ エクスプローラーで開く
- ✅ 履歴機能（最近使用10件）

### Phase 3 新機能（2024-11-23追加）

#### 🔥 一括リネーム機能（実運用版）
- **プレフィックス追加**: ファイル名の先頭に文字を追加（例: `2024_test.txt`）
- **サフィックス追加**: ファイル名の末尾に文字を追加（例: `test_完了.txt`）
- **文字列置換**: 特定の文字列を別の文字列に置換（例: `2025` → `2024`）
- **連番付与**: 連番を付けてリネーム（例: `File_001_test.txt`）
- **プレビュー機能**: 実行前に変更内容を確認
- **エラー処理**: 
  - エラー発生時は即座に全中止
  - ログファイルに詳細を記録
  - タイムスタンプ付きログ出力

#### 📦 ドラッグ&ドロップ機能
- **対応ファイル形式**:
  - Excel: `.xlsx`, `.xls`, `.xlsm`
  - テキスト: `.txt`, `.csv`
- **動作**: 
  - ファイルをウィンドウにD&D → 現在開いているフォルダにコピー
  - 同名ファイルがある場合は上書き確認
  - コピー後、自動的にファイルリスト更新

---

## 🚀 使い方

### 起動方法
```powershell
# PowerShellで実行
.\FolderNavigator_Phase3_Complete.ps1
```

### 基本操作
1. **フォルダを開く**
   - Browseボタン → フォルダを選択
   - パス入力 → Enterキー or Loadボタン
   - 履歴から選択

2. **ファイル操作**
   - フォルダをダブルクリック → フォルダを開く
   - ファイルをダブルクリック → ファイルを開く

3. **フォルダ作成**
   - **New Folder**: 任意の名前でフォルダ作成
   - **Test Folder**: `試験項目01`, `試験項目02`...と自動連番

### 一括リネーム
1. リネームしたいフォルダを開く
2. **Batch Rename** ボタンをクリック
3. リネーム方式を選択
4. 文字を入力
5. **プレビュー** ボタンで確認
6. **実行** ボタンでリネーム

**⚠️ 注意事項**:
- リネーム操作は取り消せません
- エラーが発生すると即座に中止されます
- ログファイルで処理内容を確認できます

### ドラッグ&ドロップ
1. 対象フォルダを開く
2. ExcelまたはテキストファイルをウィンドウにD&D
3. 自動的にフォルダにコピーされます

---

## 📁 ファイル構成
```
C:\Users\sakak\hierarchy-folder-navi\
├── FolderNavigator_Phase3_Complete.ps1  # メインスクリプト
├── logs\                                 # ログフォルダ
│   └── rename_YYYYMMDD_HHmmss.log       # リネームログ
├── .gitignore
└── README.md
```

---

## 📊 ログファイル

### 保存場所
```
C:\Users\sakak\hierarchy-folder-navi\logs\
```

### ファイル名形式
```
rename_YYYYMMDD_HHmmss.log
例: rename_20241123_143025.log
```

### ログ内容
- リネーム処理の開始・完了
- 各ファイルの処理状況（成功/失敗）
- エラー詳細
- 処理件数の統計

---

## ⚙️ 技術仕様

### 動作環境
- **OS**: Windows 10/11
- **PowerShell**: 5.1以降
- **必要な権限**: 
  - ファイルの読み取り
  - ファイル名の変更
  - フォルダの作成

### 技術スタック
- **言語**: PowerShell
- **UI**: WPF (XAML)
- **データグリッド**: DataGrid
- **ダイアログ**: Windows.Forms

### 制約事項
- 会社PC環境を想定（ソフトウェアインストール不要）
- スタンドアロンで動作
- 外部ライブラリ不要

---

## 🔧 開発情報

### バージョン履歴
- **v3.0.0** (2024-11-23)
  - 一括リネーム機能を実運用版に変更
  - エラー処理とログ出力を実装
  - ドラッグ&ドロップ機能を追加
  - バージョン表示を更新

- **v2.0.0** (2024-11-18)
  - Phase 2完成
  - 一括リネーム機能（テストモード）
  - プレビュー機能
  - 履歴機能

### Git管理
```bash
# リポジトリ
https://github.com/sakakik253/hierarchy-folder-navi.git

# ブランチ
- main: リリース版
- phase3-rename-dragdrop: Phase 3開発ブランチ
```

---

## 📝 今後の予定

### Phase 4候補
- [ ] ファイル移動/コピー機能（GUI操作）
- [ ] 検索機能の実装
- [ ] ブックマーク機能
- [ ] 複数フォルダの一括操作
- [ ] 設定保存機能

---

## 🐛 トラブルシューティング

### リネームが失敗する場合
1. **ファイルが使用中**
   - 他のプログラムで開いていないか確認
   - プログラムを閉じてから再試行

2. **権限エラー**
   - フォルダの書き込み権限を確認
   - 管理者として実行

3. **同名ファイルが存在**
   - プレビューで確認
   - 名前を変更してから実行

### ドラッグ&ドロップが動作しない場合
1. **対応していないファイル形式**
   - Excel (.xlsx, .xls, .xlsm) またはテキスト (.txt, .csv) のみ対応

2. **フォルダが選択されていない**
   - 先にフォルダを開いてから操作

---

## 📞 サポート

### ログの確認
問題が発生した場合は、以下のログファイルを確認してください：
```
C:\Users\sakak\hierarchy-folder-navi\logs\
```

### Git Issue
不具合や要望は、GitHubのIssueで報告してください：
```
https://github.com/sakakik253/hierarchy-folder-navi/issues
```

---

## 📄 ライセンス
社内ツールとして開発（ライセンス未定）

---

## 👤 作者
**KENJI**  
会社PC環境での業務効率化ツール開発

---

**最終更新:** 2024-11-23
